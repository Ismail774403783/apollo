{% extends "core/layout.html" %}
{% load apollo %}{% load comments %}{% load humanize %}{% load static %}
{% block content %}
  <form action="" method="post" style="margin-bottom:.5em;">
    {% csrf_token %}
  <div class="row" style="margin-bottom:4em">
    <div class="span12">
      <table class="table table-bordered">
        <thead>
          <tr>
            <th width="15%">&nbsp;</th>
            <th>1</th>
          </tr>
          <tr>
            <th>Observer</th>
            <td><strong>{{ submission.submissions.all.0.observer.observer_id }}</strong> &mdash; <strong>{{ submission.submissions.all.0.observer.name }}</strong>{% if submission.submissions.all.0.observer.phone %} ({{ submission.submissions.all.0.observer.phone }}){% endif %}</td>
          </tr>
          <tr>
            <th>Role</th>
            <td>{{ submission.submissions.all.0.observer.role }}</td>
          </tr>
          <tr>
            <th>Location</th>
            <td><strong>{{ submission.location }}</strong></td>
          </tr>
          {% if location_types %}
          <tr>
            <th>&nbsp;</th>
            <td>{% for location_type in location_types %}{% get_location_for_type submission location_type "True" %}{% if not forloop.last %} / {% endif %}{% endfor %}</td>
          </tr>
          {% endif %}
          <tr>
            <th>Supervisor</th>
            <td>{{ submission.submissions.all.0.observer.supervisor|default_if_none:"<em>N/A</em>" }}</td>
          </tr>
        </thead>
      </table>
      <table class="table table-striped table-bordered table-hover">
        <tbody>
          {% for flag in flags %}
          {% with flag.storage as field_name %}
          <tr>
            <td style="text-align: right" width="20%">{{ flag.name }}</td>
            <td>
              {% if submission.data|keyvalue:field_name|flag_status:'verified' %}<img src="{% static "img/blue_dot.png" %}" title="Verified" alt="Verified" height="13" width="13" />
              {% elif submission.data|keyvalue:field_name|flag_status:'rejected' %}<img src="{% static "img/black_dot.png" %}" title="Rejected" alt="Rejected" height="13" width="13" />
              {% elif submission.data|keyvalue:field_name|flag_status:'serious_problem' %}<img src="{% static "img/red_dot.png" %}" title="Serious Problem" alt="Serious Problem" height="13" width="13" />
              {% elif submission.data|keyvalue:field_name|flag_status:'problem' %}<img src="{% static "img/darkyellow_dot.png" %}" title="Problem" alt="Problem" height="13" width="13" />
              {% elif submission.data|keyvalue:field_name|flag_status:'no_problem' %}<img src="{% static "img/green_dot.png" %}" title="No Problem" alt="No Problem" height="13" width="13" />
              {% else %}<img src="{% static "img/white_dot.png" %}" title="No Data" alt="No Data" height="13" width="13" />
              {% endif %}
            </td>
          </tr>
          {% endwith %}
          {% endfor %}
          <tr>
            <td style="text-align: right; vertical-align: middle">{{ submission_form.data__verification.label }}</td>
            <td>{{ submission_form.data__verification }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="row navbar-fixed-bottom" style="bottom:0px; margin-left:1.75em; background:#fff; padding-top:1em; padding-bottom:1em;">
    <div class="offset8 span2">
      <button type="submit" class="btn btn-info btn-large btn-block">Save</button>
    </div>
    <div class="span2">
      <a class="btn btn-large btn-block" href="{% url verifications_list object.form.pk %}">Cancel</a>
    </div>
  </div>
  </form>
{% endblock %}
