{% extends "core/layout.html" %}
{% load apollo %}{% load static %}
{% block title %}
{{ page_title }}
{% if perms.core.export_submissions %}
<div class="btn-group pull-right">
  <form method="get"><input type="hidden" name="export" value="true" /><button class="btn" type="submit">Export</a></form>
</div>
{% endif %}
{% endblock %}
{% block content %}
<div class="row">
	<div class="span8">
		{% analysis_breadcrumb_navigation form location %}
		{% analysis_location_navigation form location %}
  	</div>
  	<div class="span4">
        <form class="form-horizontal pull-right" action="" method="post" accept-charset="utf-8">
          {% csrf_token %}
          {{ filter_form.sample }}
          <button class="btn btn-warning" style="margin-left:1em" type="submit"><i class="icon-search icon-white"></i> Filter</button>
        </form>
  	</div>
 </div>
 <div class="row">
	<div class="span12">
		{% if incidents %}
		<div class="tabbable"> <!-- Only required for left/right tabs -->
			<ul class="nav nav-tabs">
				<li class="active"><a href="#tab1" data-toggle="tab">Table</a></li>
				<li><a href="#tab2" data-toggle="tab">Map</a></li>
			</ul>
			<div class="tab-content">
			    <div class="tab-pane active" id="tab1">
<table class="table table-bordered table-striped">
    <tr>
        <td colspan="5"><strong>{{ form_field.tag }}</strong> · {{ form_field.description }}</td>
    </tr>
	<tr>
        <th>Name</th>
		<th>Location</th>
        <th style="text-align: center">Witnessed</th>
        <th style="text-align: center" width="50">Status</th>
		<th>Description</th>
	</tr>
    {% for incident in incidents %}
	<tr>
        <td>{{ incident.observer.name }}</td>
        <td>{{ incident.location }} · <em class="muted">{{ incident.location.type }}</em></td>
        <td style="text-align: center">
        {% with incident.data.witness as witness %}
        {% if witness == 'witnessed' %}
            <i class="icon-eye-open" title="Witnessed incident"></i>
        {% elif witness == 'after' %}
            <i class="icon-eye-close" title="Arrived after incident"></i>
        {% elif witness == 'reported' %}
            <i class="icon-user" title="Incident was reported"></i>
        {% else %}
            &nbsp;
        {% endif %}
        {% endwith %}
        </td>
        <td style="text-align: center">
        {% with incident.data.status as status %}
        {% if status == 'confirmed' %}
        <img src="{% static "img/tick.png" %}" title="Confirmed" alt="Confirmed" />
        {% elif status == 'rejected' %}
        <img src="{% static "img/red_dot.png" %}" title="Rejected" alt="Rejected" />
        {% else %}
        <img src="{% static "img/caution.png" %}" title="Unmarked" alt="Unmarked" />
        {% endif %}
        {% endwith %}
        </td>
		<td>{{ incident.data.description }}</td>
	</tr>
    {% endfor %}
</table>
				</div>
				<!--Chart-->
				<div class="tab-pane" id="tab2">
				</div>
			</div>
		</div>
		{% else %}
		<table class="table table-striped table-bordered table-hover">
			<tr class="warning">
				<td style="text-align:center">No Data Available</td>
			</tr>
		</table>
		{% endif %}
	</div>
</div>
{% endblock %}
