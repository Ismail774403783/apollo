{% extends "core/layout.html" %}{% load bootstrap_pagination %}{% load i18n %}
{% block title %}
{{ page_title }}
{% if perms.messagelog.export_messages %}

<form action="{% url messages_list %}" method="get" id="export_messages" style="display:none">
  <input type="hidden" name="export" value="true" />
</form>

<a class="btn btn-default pull-right" href="javascript:document.getElementById('export_messages').submit()">{% trans "Export" context "verb" %}</a>
{% endif %}
{% endblock %}
{% block content %}
<div class="row">
  <div class="col-md-12">
    <div class="well well-sm">
      <form action="{% url messages_list %}" method="get" id="filter" class="form-inline">
        <div class="form-group">
          {{ filter_form.mobile }}
          {{ filter_form.text }}
        </div>
        <div class=" form-group">
          <div class="input-group date span2 datesel" data-date="" data-date-format="dd-mm-yyyy">
            <input class="span2 form-control" name="created" placeholder="{% trans "Date" %}" style="width:129px;" size="16" type="text" value="{{ filter_form.created.value|default_if_none:"" }}" readonly="readonly">
            <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
          </div>
        </div>
        <button type="submit" class="btn btn-warning"><i class="glyphicon glyphicon-search"></i> {% trans "Filter" context "verb" %}</button> <a class="btn btn-default form-reset" style="margin-left:0.5em">{% trans "Clear" context "verb" %}</a>
      </form>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-12">
    <table class="table table-striped table-bordered table-hover" style="table-layout:fixed">
      <thead >
        <tr>
          <th width="7%">{% trans "Date" %}</th>
          <th width="7%">{% trans "Time" %}</th>
          <th width="10%">{% trans "Mobile" %}</th>
          <th width="7%">{% trans "Direction" %}</th>
          <th width="60%">{% trans "Text" %}</th>
        </tr>
      </thead>
      <tbody>
        {% for message in messages %}
        <tr>
          <td>{{ message.created|date:"D j-M" }}</td>
          <td>{{ message.created|date:"g:i a" }}</td>
          <td>{{ message.mobile }}</td>
          <td>{% if message.direction == 1 %}{% trans "IN" context "adjective" %}{% else %}{% trans "OUT" context "adjective" %}{% endif %}</td>
          <td style="word-wrap:break-word">{{ message.text }}</td>
        </tr>
        {% empty %}
        <tr class="warning">
          <td style="text-align:center" colspan="5">{% trans "No Data Available" %}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

{% if is_paginated %}
<div class="row">
  <div class="col-md-12">
  {% bootstrap_paginate page_obj range=10 show_first_last="true" %}
  </div>
</div>
{% endif %}
{% endblock %}
