<script type="text/x-handlebars-template" id="screen-zambia-dashboard-template" charset="utf-8">
	<div class="page-title">
		<div class="page-title-content">
			<div class="page-title-info left">
				<h1>{{title}}</h1>
			</div>
			<p class="clr"></p>
		</div>
	</div>
	<div class="full_width_content">
		<table border="0" cellpadding="5" width="100%">
			<tr>
			<td valign="top">
			<h1>Setup</h1>
			<img src='/assets/images/dash/bar1.png' style="margin-bottom:2em" />
			<h1 id="voting">Voting</h1>
			<img src='/assets/images/dash/bar2.png' style="margin-bottom:2em" />
			<h1 id="closing">Closing</h1>
			<img src='/assets/images/dash/bar3.png' style="margin-bottom:2em" />
			<h1 id="counting">Counting</h1>
			<img src='/assets/images/dash/bar4.png' style="margin-bottom:2em" />
			</td>
			<td><img src='/assets/images/dash/zam_province.png' width='214' height='303' /></td>
			</tr>
		</table>
	</div>
</script>
<script type="text/x-handlebars-template" id="checklist-filter-template" charset="utf-8">
	<div id="filter" class="filter_pane">
		<form id="search">
		<div class="input_el"><input type="text" name="observer_id" class="input_smoke search_field" placeholder="Monitor Id" id="search_observer__observer_id__exact" pattern=".*[0-9]" title="Numeric figures only"></div>
		<div class="input_el"><input type="text" name="date" class="input_smoke search_field date_field" placeholder="Date" id="search_date__exact"></div>
		<div class="input_el"><input type="text" name="location" class="input_smoke" placeholder="Location" id="location__id"></div>
		<div class="clear"></div>
		<div class="input_el">
			<select name="setup_status" id="search_setup_status" class="input_smoke search_field">
				<option value="">Setup Status</option>
				<option value="1">Setup Complete</option>
				<option value="2">Setup Missing</option>
				<option value="3">Setup Partial</option>
			</select>
		</div>
		<div class="input_el">
			<select name="voting_status" id="search_voting_status" class="input_smoke search_field">
				<option value="">Voting Status</option>
				<option value="1">Voting Complete</option>
				<option value="2">Voting Missing</option>
				<option value="3">Voting Partial</option>
			</select>
		</div>
		<div class="input_el">
			<select name="closing_status" id="search_closing_status" class="input_smoke search_field">
				<option value="">Closing Status</option>
				<option value="1">Closing Complete</option>
				<option value="2">Closing Missing</option>
				<option value="3">Closing Partial</option>
			</select>
		</div>
		<div class="input_el">
			<select name="counting_status" id="search_counting_status" class="input_smoke search_field">
				<option value="">Counting Status</option>
				<option value="1">Counting Complete</option>
				<option value="2">Counting Missing</option>
				<option value="3">Counting Partial</option>
			</select>
		</div>
		<div class="input_el">
			<span class="btn_blue btn_space"><input type="submit" name="submit" value="Filter" class="search_btn"><span>&nbsp;</span></span><span class="btn_gray btn_space"><a href="javascript:;" id="form_reset">Reset</a><span>&nbsp;</span></span><span class="btn_yellow"><a href='javascript:;' class="sms_sender">SMS</a><span>&nbsp;</span></span>
		</div>
		</form>
		<div class="clear"></div>
	</div>
	<div class="filter_pane_bottom"></div>
	<div id="filter_dropper">Filter</div>
	<div style="margin-top:2em"></div>
</script>
<script type="text/x-handlebars-template" id="checklist-header-template" charset="utf-8">
	<tbody>
		<tr><th><a href="javascript:;" class="sortable_column" id="sort_observer__observer_id">Monitor Id</a></th><th><a href="javascript:;" class="sortable_column" id="sort_date">Date</a></th><th><a href="javascript:;" class="sortable_column" id="sort_location__parent__parent__parent__name">Ward</a></th><th><a href="javascript:;" class="sortable_column" id="sort_location__parent__parent__name">Polling District</a></th><th><a href="javascript:;" class="sortable_column" id="sort_observer__supervisor__name">Supervisor</a></th><th><a href="javascript:;" class="sortable_column" id="sort_observer__name">Monitor</a></th><th style="text-align:center"><span title="Setup">S</span></th><th style="text-align:center"><span title="Voting">V</span></th><th style="text-align:center"><span title="Closing">C</span></th><th style="text-align:center"><span title="Counting">C</span></th><th style="text-align:center">Edit</th></tr>
	</tbody>
</script>
<script type="text/x-handlebars-template" id="checklist-template" charset="utf-8">
	<td>{{observer.attributes.observer_id}}</td><td>{{date}}</td><td>{{location.attributes.parent.attributes.parent.attributes.parent.attributes.name}}</td><td>{{location.attributes.parent.attributes.parent.attributes.name}}</td><td>{{#if observer.attributes.supervisor}}{{observer.attributes.supervisor.attributes.name}}{{#if observer.attributes.supervisor.attributes.connections.models}} (<strong>{{observer.attributes.supervisor.attributes.connections.models.0.attributes.identity}}</strong>){{/if}}{{else}}&nbsp;{{/if}}</td><td>{{observer.attributes.name}}{{#if observer.attributes.connections.models}} (<strong>{{observer.attributes.connections.models.0.attributes.identity}}</strong>){{/if}}</td><td align="center">{{setup_flag response}}</td><td align="center">{{voting_flag response}}</td><td align="center">{{closing_flag response}}</td><td align="center">{{counting_flag response}}</td><td align="center">Edit</td>
</script>
<script type="text/x-handlebars-template" id="checklist-empty-template" charset="utf-8">
	<tr><td colspan="11" class="empty"><em>No checklists to display</em></td></tr>
</script>
<script type="text/x-handlebars-template" id="contact-search-template" charset="utf-8">
	<div class="search_pane_dashboard">
		<form id="search">
		<div class="input_el"><input type="text" name="observer_id" class="input_smoke search_field" id="search_observer_id" placeholder="Monitor ID" pattern=".*[0-9]" title="Numeric figures only"></div>
		<div class="input_el"><input type="text" name="name" class="input_smoke search_field" id="search_name__icontains" placeholder="Name"></div>
		<div class="input_el"><input type="text" name="phone" class="input_smoke search_field" id="search_connections__identity__endswith" placeholder="Phone Number" pattern=".*[0-9]" title="Numeric figures only"></div>		
		<div class="input_el"><input type="text" name="location" class="input_smoke" id="location__id" placeholder="Location"></div>
		<div class="clear"></div>
		<div class="input_el">
			<select name="partner" id="search_partner" class="input_smoke search_field">
				<option value="">Partner Organization</option>
				<option value="Caritas">Caritas</option>
				<option value="FODEP">FODEP</option>
			</select>
		</div>
		<div class="input_el">
			<select name="cell_coverage" id="search_cell_coverage" class="input_smoke search_field">
				<option value="">Cell Coverage</option>
				<option value="1">Cell Coverage - Yes</option>
				<option value="0">Cell Coverage - No</option>
			</select>
		</div>
		<div class="input_el">
			<span class="btn_blue btn_space"><input type="submit" name="submit" value="Search" class="search_btn"><span>&nbsp;</span></span><span class="btn_gray btn_space"><a href="javascript:;" id="form_reset">Reset</a><span>&nbsp;</span></span><span class="btn_yellow"><a href='javascript:;' class="sms_sender">SMS</a><span>&nbsp;</span></span>
		</div>
		</form>
		<div class="clear"></div>
	</div>
</script>
<script type="text/x-handlebars-template" id="contact-header-template" charset="utf-8">
	<tbody>
		<tr><th><a href="javascript:;" class="sortable_column" id="sort_observer_id">Monitor Id</a></th><th><a href="javascript:;" class="sortable_column" id="sort_name">Name</a></th><th><a href="javascript:;" class="sortable_column" id="sort_role__name">Role</a></th><th><a href="javascript:;" class="sortable_column" id="sort_connections__identity">Phone No.</a></th><th><a href="javascript:;" class="sortable_column" id="sort_location__name">Location</a></th><th><a href="javascript:;" class="sortable_column" id="sort_partner">Partner</a></th><th style="text-align:center">Edit</th></tr>
	</tbody>
</script>
<script type="text/x-handlebars-template" id="contact-template" charset="utf-8">
	<td>{{observer_id}}</td><td>{{name}}</td><td>{{role.name}}</td><td>{{connections.models.0.attributes.identity}}</td><td>{{location.attributes.name}} ({{location.attributes.type.name}})</td><td>{{partner}}</td><td style="text-align:center"><a href="#!/contact/{{id}}">Edit</a></td>
</script>
<script type="text/x-handlebars-template" id="contact-empty-template" charset="utf-8">
	<tr><td colspan="7" class="empty"><em>No contacts to display</em></td></tr>
</script>
<script type="text/x-handlebars-template" id='contact-edit-template' charset="utf-8">
	<form id="contact_form" class="edit_form_floated">
	<label for="observer_id"><span class="label">Monitor ID</span> <input type="text" id="observer_id" name="observer_id" class="input_smoke field" value="{{observer_id}}"></label>
	<label for="nrc"><span class="label">NRC No.</span> <input type="text" id="nrc" name="nrc" class="input_smoke field" value="{{nrc}}"></label>
	<label for="name"><span class="label">Name</span> <input type="text" name="name" id="name" class="input_smoke field" value="{{name}}"></label>
	<label for="role"><span class="label">Role</span> <select name="role" id="role" class="input_smoke field">
		<option value='/api/v1/contact_role/1/'>District Supervisor</option>
		<option value='/api/v1/contact_role/2/'>Monitor</option>
	</select></label>
	<label for="location"><span class="label">Location</span> <input type="text" name="location" id="location" class="input_smoke" value="{{location.attributes.name}}"></label>
	<label for="gender"><span class="label">Gender</span> <select name="gender" id="gender" class="input_smoke field">
		<option value='M'>Male</option>
		<option value='F'>Female</option>
	</select></label>
	<label for="phone"><span class="label">Phone</span> <input type="text" name="phone" id="connections.models[0].attributes.identity" class="input_smoke field" value="{{connections.models.0.attributes.identity}}"></label>
	<label for="partner"><span class="label">Partner</span> <select name="partner" id="partner" class="input_smoke field">
		<option value="Caritas">Caritas</option>
		<option value="FODEP">FODEP</option>
	</select></label>
	<label for="cell_coverage"><span class="label">Cell Coverage</span> <select name="cell_coverage" id="cell_coverage" class="input_smoke field">
		<option value='1'>Yes</option>
		<option value='0'>No</option>
	</select></label>
	<label for="submit"><span class="label">&nbsp;</span> <span class="btn_yellow btn_space"><input type="submit" name="submit" value="Save"><span>&nbsp;</span></span></label>
	</form>
</script>
<script type="text/x-handlebars-template" id="incident-filter-template" charset="utf-8">
	<div class="search_pane_dashboard">
		<form id="search">
		<div class="input_el"><input type="text" name="observer_id" class="input_smoke search_field" placeholder="Monitor Id" id="search_observer__observer_id__exact" pattern=".*[0-9]" title="Numeric figures only"></div>
		<div class="input_el"><input type="text" name="date" class="input_smoke search_field date_field" placeholder="Date" id="search_date__exact"></div>
		<div class="input_el"><input type="text" name="location" class="input_smoke" placeholder="Location" id="location__id"></div>
		<div class="input_el">
			<span class="btn_blue btn_space"><input type="submit" name="submit" value="Filter" class="search_btn"><span>&nbsp;</span></span><span class="btn_gray btn_space"><a href="javascript:;" id="form_reset">Reset</a><span>&nbsp;</span></span><span class="btn_yellow"><a href='javascript:;' class="sms_sender">SMS</a><span>&nbsp;</span></span>
		</div>
		</form>
		<div class="clear"></div>
	</div>
</script>
<script type="text/x-handlebars-template" id="incident-header-template" charset="utf-8">
	<tbody>
		<tr><th><a href="javascript:;" class="sortable_column" id="sort_observer__observer_id">PSID</a></th><th><a href="javascript:;" class="sortable_column" id="sort_date">Date</a></th><th><a href="javascript:;" class="sortable_column" id="sort_location__parent__parent__parent__name">Ward</a></th><th><a href="javascript:;" class="sortable_column" id="sort_location__parent__parent__name">Polling District</a></th><th><a href="javascript:;" class="sortable_column" id="sort_observer__name">Monitor</a></th><th style="text-align:center"><span>A</span></th><th style="text-align:center"><span>B</span></th><th style="text-align:center"><span>C</span></th><th style="text-align:center"><span>D</span></th><th style="text-align:center"><span>E</span></th><th style="text-align:center"><span>F</span></th><th style="text-align:center"><span>G</span></th><th style="text-align:center"><span>H</span></th><th style="text-align:center"><span>I</span></th><th style="text-align:center"><span>J</span></th><th style="text-align:center"><span>K</span></th><th style="text-align:center"><span>K1</span></th><th style="text-align:center"><span>K2</span></th><th style="text-align:center"><span>K4</span></th><th style="text-align:center"><span>L</span></th><th style="text-align:center"><span>M</span></th><th style="text-align:center"><span>N</span></th><th style="text-align:center"><span>O</span></th><th style="text-align:center">Edit</th><th style="text-align:center">Del</th></tr>
	</tbody>
</script>
<script type="text/x-handlebars-template" id="incident-template" charset="utf-8">
	<td>{{observer.attributes.observer_id}}</td><td>{{date}}</td><td>{{location.attributes.parent.attributes.parent.attributes.parent.attributes.name}}</td><td>{{location.attributes.parent.attributes.parent.attributes.name}}</td><td>{{observer.attributes.name}}{{#if observer.attributes.connections.models}} (<strong>{{observer.attributes.connections.models.0.attributes.identity}}</strong>){{/if}}</td><td align="center">{{incident_flag response "A"}}</td><td align="center">{{incident_flag response "B"}}</td><td align="center">{{incident_flag response "C"}}</td><td align="center">{{incident_flag response "D"}}</td><td align="center">{{incident_flag response "E"}}</td><td align="center">{{incident_flag response "F"}}</td><td align="center">{{incident_flag response "G"}}</td><td align="center">{{incident_flag response "H"}}</td><td align="center">{{incident_flag response "I"}}</td><td align="center">{{incident_flag response "J"}}</td><td align="center">{{incident_flag response "K"}}</td><td align="center">{{incident_flag response "K1"}}</td><td align="center">{{incident_flag response "K2"}}</td><td align="center">{{incident_flag response "K4"}}</td><td align="center">{{incident_flag response "L"}}</td><td align="center">{{incident_flag response "M"}}</td><td align="center">{{incident_flag response "N"}}</td><td align="center">{{incident_flag response "O"}}</td><td align="center">Edit</td><td align="center">Del</td>
</script>
<script type="text/x-handlebars-template" id="incident-empty-template" charset="utf-8">
	<tr><td colspan="25" class="empty"><em>No incidents to display</em></td></tr>
</script>
<script type="text/javascript" charset="utf-8">
	function checklist_setup_complete(response) {
	    return _.all(['A', 'B', 'CA', 'CB', 'CC', 'CE', 'CF', 'CG', 'CH', 'D', 'E', 'EA', 
	        'EB', 'EC', 'F', 'G', 'H', 'J', 'K'], function (code) {
			return response.get(code);
	    });
	}

	function checklist_setup_missing(response) {
	    return !_.any(['A', 'B', 'CA', 'CB', 'CC', 'CE', 'CF', 'CG', 'CH', 'D', 'E', 'EA', 
	        'EB', 'EC', 'F', 'G', 'H', 'J', 'K'], function (code) {
			return response.get(code);
	    });
	}

	function checklist_setup_partial(response) {
	    return _.any(['A', 'B', 'CA', 'CB', 'CC', 'CE', 'CF', 'CG', 'CH', 'D', 'E', 'EA',
	        'EB', 'EC', 'F', 'G', 'H', 'J', 'K'], function (code) {
			return response.get(code);
	    });
	}
	
	function checklist_voting_complete(response) {
	    return _.all(['K', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W'], function (code) {
			return response.get(code);
	    });
	}

	function checklist_voting_missing(response) {
	    return !_.any(['K', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W'], function (code) {
			return response.get(code);
	    });
	}

	function checklist_voting_partial(response) {
	    return _.any(['K', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W'], function (code) {
			return response.get(code);
	    });
	}
	
	function checklist_closing_complete(response) {
	    return _.all(['X', 'Y', 'Z', 'AA'], function (code) {
			return response.get(code);
	    });
	}

	function checklist_closing_missing(response) {
	    return !_.any(['X', 'Y', 'Z', 'AA'], function (code) {
			return response.get(code);
	    });
	}

	function checklist_closing_partial(response) {
	    return _.any(['X', 'Y', 'Z', 'AA'], function (code) {
			return response.get(code);
	    });
	}
	
	function checklist_counting_complete(response) {
	    return _.all(['AB', 'AC', 'AD', 'AEAA', 'AEAB', 'AEAC', 'AEAD', 'AEAE', 'AEAF', 'AEBA', 'AEBB', 'AEBC', \
        'AEBD', 'AEBE', 'AEBF', 'AECA', 'AECB', 'AECC', 'AECD', 'AECE', 'AECF', 'AEDA', 'AEDB', \
        'AEDC', 'AEDD', 'AEDE', 'AEDF', 'AEEA', 'AEEB', 'AEEC', 'AEED', 'AEEE', 'AEEF', 'AFAA', \
        'AFAB', 'AFAC', 'AFAD', 'AFAE', 'AFAF', 'AFBA', 'AFBB', 'AFBC', 'AFBD', 'AFBE', 'AFBF', \
        'AG', 'AH', 'AJ', 'AK'], function (code) {
			return response.get(code);
	    });
	}

	function checklist_counting_missing(response) {
	    return !_.any(['AB', 'AC', 'AD', 'AEAA', 'AEAB', 'AEAC', 'AEAD', 'AEAE', 'AEAF', 'AEBA', 'AEBB', 'AEBC', \
        'AEBD', 'AEBE', 'AEBF', 'AECA', 'AECB', 'AECC', 'AECD', 'AECE', 'AECF', 'AEDA', 'AEDB', \
        'AEDC', 'AEDD', 'AEDE', 'AEDF', 'AEEA', 'AEEB', 'AEEC', 'AEED', 'AEEE', 'AEEF', 'AFAA', \
        'AFAB', 'AFAC', 'AFAD', 'AFAE', 'AFAF', 'AFBA', 'AFBB', 'AFBC', 'AFBD', 'AFBE', 'AFBF', \
        'AG', 'AH', 'AJ', 'AK'], function (code) {
			return response.get(code);
	    });
	}

	function checklist_counting_partial(response) {
	    return _.any(['AB', 'AC', 'AD', 'AEAA', 'AEAB', 'AEAC', 'AEAD', 'AEAE', 'AEAF', 'AEBA', 'AEBB', 'AEBC', \
        'AEBD', 'AEBE', 'AEBF', 'AECA', 'AECB', 'AECC', 'AECD', 'AECE', 'AECF', 'AEDA', 'AEDB', \
        'AEDC', 'AEDD', 'AEDE', 'AEDF', 'AEEA', 'AEEB', 'AEEC', 'AEED', 'AEEE', 'AEEF', 'AFAA', \
        'AFAB', 'AFAC', 'AFAD', 'AFAE', 'AFAF', 'AFBA', 'AFBB', 'AFBC', 'AFBD', 'AFBE', 'AFBF', \
        'AG', 'AH', 'AJ', 'AK'], function (code) {
			return response.get(code);
	    });
	}
</script>
<script type="text/javascript" charset="utf-8">
	Handlebars.registerHelper('setup_flag', function (responses) {
		if (checklist_setup_complete(responses)) {
			return new Handlebars.SafeString('<img src="/assets/images/tick.png" alt="complete" />');
		} else if (checklist_setup_missing(responses)) {
			return new Handlebars.SafeString('<img src="/assets/images/red_dot.png" alt="missing" />');
		} else {
			return new Handlebars.SafeString('<img src="/assets/images/caution.png" alt="partial" />');
		}
	});
	Handlebars.registerHelper('voting_flag', function (responses) {
		if (checklist_voting_complete(responses)) {
			return new Handlebars.SafeString('<img src="/assets/images/tick.png" alt="complete" />');
		} else if (checklist_voting_missing(responses)) {
			return new Handlebars.SafeString('<img src="/assets/images/red_dot.png" alt="missing" />');
		} else {
			return new Handlebars.SafeString('<img src="/assets/images/caution.png" alt="partial" />');
		}
	});
	Handlebars.registerHelper('closing_flag', function (responses) {
		if (checklist_closing_complete(responses)) {
			return new Handlebars.SafeString('<img src="/assets/images/tick.png" alt="complete" />');
		} else if (checklist_closing_missing(responses)) {
			return new Handlebars.SafeString('<img src="/assets/images/red_dot.png" alt="missing" />');
		} else {
			return new Handlebars.SafeString('<img src="/assets/images/caution.png" alt="partial" />');
		}
	});
	Handlebars.registerHelper('counting_flag', function (responses) {
		if (checklist_counting_complete(responses)) {
			return new Handlebars.SafeString('<img src="/assets/images/tick.png" alt="complete" />');
		} else if (checklist_counting_missing(responses)) {
			return new Handlebars.SafeString('<img src="/assets/images/red_dot.png" alt="missing" />');
		} else {
			return new Handlebars.SafeString('<img src="/assets/images/caution.png" alt="partial" />');
		}
	});
	Handlebars.registerHelper('incident_flag', function (responses, attribute) {
		if (responses.get(attribute)) {
			return new Handlebars.SafeString('<img src="/assets/images/red_dot.png" />');
		} else {
			return new Handlebars.SafeString('&nbsp;');
		}
	});
	
	Templates = (typeof(Templates) == 'undefined') ? {} : Templates;
	Templates.ChecklistFilter = Handlebars.compile($('#checklist-filter-template').html());
	Templates.ChecklistHeader = Handlebars.compile($('#checklist-header-template').html());
	Templates.Checklist = Handlebars.compile($('#checklist-template').html());
	Templates.ChecklistEmpty = Handlebars.compile($('#checklist-empty-template').html());
	Templates.ZambiaDashboardScreen = Handlebars.compile($('#screen-zambia-dashboard-template').html());
	Templates.ContactSearch = Handlebars.compile($('#contact-search-template').html());
	Templates.Contact = Handlebars.compile($('#contact-template').html());
	Templates.ContactEmpty = Handlebars.compile($('#contact-empty-template').html());
	Templates.ContactHeader = Handlebars.compile($('#contact-header-template').html());
	Templates.ContactEdit = Handlebars.compile($('#contact-edit-template').html());
	Templates.IncidentFilter = Handlebars.compile($('#incident-filter-template').html());
	Templates.IncidentHeader = Handlebars.compile($('#incident-header-template').html());
	Templates.Incident = Handlebars.compile($('#incident-template').html());
	Templates.IncidentEmpty = Handlebars.compile($('#incident-empty-template').html());
</script>