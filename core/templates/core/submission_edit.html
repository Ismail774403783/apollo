{% extends "core/layout.html" %}
{% load apollo %}
{% block content %}
  {% with submission.siblings as siblings %}
  <style type="text/css">
    .options {
      display: block;
      margin-top: 0.5em;
    }
  </style>
  <div class="row">
    <div class="span12">
      <h2>Submission Edit</h2>
    </div>
  </div>

  <form action="" method="post">
    {% csrf_token %}
  <div class="row">
    <div class="span12">
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>&nbsp;</th>
            <th>1</th>
            {% for sibling in siblings %}
            <th>{{ forloop.counter|add:"1" }}</th>
            {% endfor %}
          </tr>
          <tr>
            <th>Monitor</th>
            <td>{{ submission.observer }}</td>
            {% for sibling in siblings %}
            <td>{{ sibling.observer }}</td>
            {% endfor %}
          </tr>
          <tr>
            <th>Location</th>
            <td>{{ submission.location }}</td>
            {% for sibling in siblings %}
            <td>{{ sibling.location }}</td>
            {% endfor %}
          </tr>
          <tr>
            <th>Supervisor</th>
            <td>{{ submission.observer.supervisor }}</td>
            {% for sibling in siblings %}
            <td>{{ sibling.observer.supervisor|default_if_none:"" }}</td>
            {% endfor %}
          </tr>
        </thead>
      </table>
      <table class="table table-striped table-bordered table-hover">
        <tbody>
          <tr>
            <td colspan="2">&nbsp;</td>
            <td style="text-align:center"><strong>1</strong></td>
            {% for sibling in siblings %}
            <td style="text-align:center"><strong>{{ forloop.counter|add:"1" }}</strong></td>
            {% endfor %}
            <td>&nbsp;</td>
          </tr>
          {% for fieldset in form.fieldsets %}
          {% if fieldset.legend %}
          <tr>
            <td colspan="{{ siblings.count|add:"4" }}"><h4 class="{{ fieldset.classes }}">{{ fieldset.legend }}</h4></td>
          </tr>
          {% endif %}
          {% for field in fieldset %}
          <tr{% if field.name in object.overrides %} class="warning"{% endif %}>
            <td>{{ field.name }}</td>
            <td>{{ field.help_text }}
              {% if field.field.choices %}
              <span class="options">
                {% for choice in field.field.choices %}
                {{ choice.1 }} <strong>({{ choice.0 }})</strong>
                {% endfor %}
              </span>
              {% endif %}
            </td>
            <td style="text-align:center"><input class="input-mini uneditable-input" disabled="disabled" value="{{ submission.data|keyvalue:field.name }}" type="text" /></td>
            {% for sibling in siblings %}
            <td style="text-align:center"><input class="input-mini uneditable-input" disabled="disabled"  value="{{ sibling.data|keyvalue:field.name }}" type="text" /></td>
            {% endfor %}
            <td style="text-align:center">{{ field }}</td>
          </tr>
          {% endfor %}
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="row">
    <div class="offset8 span2">
      <button type="submit" class="btn btn-info btn-large btn-block">Save</button>
    </div>
    <div class="span2">
      <a class="btn btn-large btn-block" href="{% url submissions_list object.form.pk %}">Cancel</a>
    </div>
  </div>
  </form>

  <div class="row">
    <p>&nbsp;</p>
  </div>
  {% endwith %}
{% endblock %}
