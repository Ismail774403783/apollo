{% extends 'psc/layout.html' %}
{% block javascripts %}
{{ block.super }}
<script src="/assets/js/jquery-1.4.4.min.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" charset="utf-8">
    $(function() {
        $("#reset").click(function () {
            $("#id_date").val("");
            $("#id_sample").val("");
		});
    });
</script>
<style>
    .mid th, .mid td { vertical-align: middle; }
</style>
{% endblock %}
{% load calc %}
{% load dict-filters %}
{% block content %}
<div class="grid_16">
    <div class="box">
        <div class="block">
            <div id="filter">
                <form action="" method="get" id="filter_form" accept-charset="utf-8">
                    <table>
                        <thead>
                            <tr>
                                <th width="10%">{{ filter_form.date.label }}</th>
								<th width="10%">{{ filter_form.sample.label }}</th>
                                <th>&nbsp;</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>{{ filter_form.date }}</td>
                                <td>{{ filter_form.sample }}</td>
                                <td><input type="button" value="reset" id="reset"> <input type="submit" value="filter &rarr;"></td>
                            </tr>
                        </tbody>
                    </table>
                </form>
            </div>
        </div>
    </div>
    <div class="box">
	<h2><strong>Turnout Analysis for Zone</strong></h2>
	<div class="block">
		<table width="100%" class="summary">
		    <thead>
			<tr>
			    <th>Zone</th>
			    <th>N</th>
			    <th>n</th>
			    <th>n%</th>
			    <th>RV</th>
			    <th>T</th>
			    <th>T%</th>
			</tr>
		    </thead>
			{% for zone in turnout.zones %}
			<tr {% cycle '' 'class="odd"' %}>
			    <td>{{ zone.name }}</td>
			    <td>{{ zone.N }}</td>
			    <td>{{ zone.n }}</td>
			    <td>{{ zone.n|percentage:zone.N }}</td>
			    <td>{{ zone.RV }}</td>
			    <td>{{ zone.T }}</td>
			    <td>{{ zone.T|percentage:zone.RV }}</td>
			</tr>
			{% endfor %}
			<tr>
			    <th>Totals</th>
			    <th>{{ turnout.zone.totals.N }}</th>
			    <th>{{ turnout.zone.totals.n }}</th>
			    <th>{{ turnout.zone.totals.n|percentage:turnout.zone.totals.N }}</th>
			    <th>{{ turnout.zone.totals.RV }}</th>
			    <th>{{ turnout.zone.totals.T }}</th>
			    <th>{{ turnout.zone.totals.T|percentage:turnout.zone.totals.RV }}</th>
			</tr>
		</table>
	</div>
    </div>
	<div class="box">
	<h2><strong>Turnout Analysis for State</strong></h2>
	<div class="block">
		<table width="100%" class="summary">
		    <thead>
			<tr>
			    <th>State</th>
			    <th>N</th>
			    <th>n</th>
			    <th>n%</th>
			    <th>RV</th>
			    <th>T</th>
			    <th>T%</th>
			</tr>
		    </thead>
			{% for state in turnout.states %}
			<tr {% cycle '' 'class="odd"' %}>
			    <td>{{ state.name }}</td>
			    <td>{{ state.N }}</td>
			    <td>{{ state.n }}</td>
			    <td>{{ state.n|percentage:state.N }}</td>
			    <td>{{ state.RV }}</td>
			    <td>{{ state.T }}</td>
			    <td>{{ state.T|percentage:state.RV }}</td>
			</tr>
			{% endfor %}
			<tr>
			    <th>Totals</th>
			    <th>{{ turnout.state.totals.N }}</th>
			    <th>{{ turnout.state.totals.n }}</th>
			    <th>{{ turnout.state.totals.n|percentage:turnout.state.totals.N }}</th>
			    <th>{{ turnout.state.totals.RV }}</th>
			    <th>{{ turnout.state.totals.T }}</th>
			    <th>{{ turnout.state.totals.T|percentage:turnout.state.totals.RV }}</th>
			</tr>
		</table>
	</div>
    </div>
	<div class="box">
	<h2><strong>Qualitative Analysis for Country</strong></h2>
	<div class="block">
		<table width="100%" class="summary">
		    <thead>
			<tr>
			    <th>Party</th>
			    <th colspan="4">Nigeria</th>
			</tr>
			<tr>
			    <th>&nbsp;</th>
			    <th>n</th>
			    <th>n%</th>
			    <th>ME95</th>
				<th>ME99</th>
			</tr>
		    </thead>
			{% for party in party_codes %}
			<tr {% cycle '' 'class="odd"' %}>
			    <td>{{ party_names|key_value:party }}</td>
			{% with results.national|key_value:party|key_value:'N' as en %}
			    <td>{{ results.national|key_value:party|key_value:'n' }}</td>
				<td>{{ results.national|key_value:party|key_value:'n'|percentage:en }}</td>
				<td>{{ results.national|key_value:party|key_value:'moe95'|stringformat:'.2f'|default:"0" }}%</td>
				<td>{{ results.national|key_value:party|key_value:'moe99'|stringformat:'.2f'|default:"0" }}%</td>
			{% endwith %}
			</tr>
			{% endfor %}
			<tr>
			    <th>Totals</th>
			    <th>{{ results.national|key_value:'EA'|key_value:'N' }}</th>
				<th>100%</th>
				<th>&nbsp;</th>
				<th>&nbsp;</th>
			</tr>
		</table>
	</div>
    </div>
    <div class="box">
	<h2><strong>Qualitative Analysis for Zones</strong></h2>
	<div class="block">
		<table width="100%" class="summary">
		    <thead>
			<tr>
			    <th>Party</th>
				{% for zone in results.zones  %}
			    <th colspan="3">{{ zone }}</th>
				{% endfor %}
			</tr>
			<tr>
			    <th>&nbsp;</th>
				{% for zone in results.zones  %}
			    <th>n</th>
			    <th>n%</th>
			    <th>ME95</th>
				{% endfor %}
			</tr>
		    </thead>
			{% for party in party_codes %}
			<tr {% cycle '' 'class="odd"' %}>
			    <td>{{ party_names|key_value:party }}</td>
			{% for zone in results.zones %}
			{% with results.zone.parties|key_value:party|key_value:zone|key_value:'N' as en %}
			    <td>{{ results.zone.parties|key_value:party|key_value:zone|key_value:'n' }}</td>
				<td>{{ results.zone.parties|key_value:party|key_value:zone|key_value:'n'|percentage:en }}</td>
				<td>{{ results.zone.parties|key_value:party|key_value:zone|key_value:'moe95'|stringformat:'.2f'|default:"0" }}%</td>
			{% endwith %}
			{% endfor %}
			</tr>
			{% endfor %}
			<tr>
			    <th>Totals</th>
			{% for zone in results.zones %}
			    <th>{{ results.zone.party_totals|key_value:zone|key_value:'n' }}</th>
				<th>100%</th>
				<th>&nbsp;</th>
			{% endfor %}
			</tr>
		</table>
	</div>
    </div>
	<div class="box">
	<h2><strong>Qualitative Analysis for States</strong></h2>
	<div class="block">
		<table width="100%" class="summary">
		    <thead>
			<tr>
			    <th>Party</th>
				{% for state in results.states  %}
			    <th colspan="3">{{ state }}</th>
				{% endfor %}
			</tr>
			<tr>
			    <th>&nbsp;</th>
				{% for state in results.states  %}
			    <th>n</th>
			    <th>n%</th>
				{% endfor %}
			</tr>
		    </thead>
			{% for party in party_codes %}
			<tr {% cycle '' 'class="odd"' %}>
			    <td>{{ party_names|key_value:party }}</td>
			{% for state in results.states %}
			{% with results.state.parties|key_value:party|key_value:state|key_value:'N' as en %}
			    <td>{{ results.state.parties|key_value:party|key_value:state|key_value:'n' }}</td>
				<td>{{ results.state.parties|key_value:party|key_value:state|key_value:'n'|percentage:en }}</td>
			{% endwith %}
			{% endfor %}
			</tr>
			{% endfor %}
			<tr>
			    <th>Totals</th>
			{% for state in results.states %}
			    <th>{{ results.state.party_totals|key_value:state|key_value:'n'|default:"0" }}</th>
				<th>100%</th>
			{% endfor %}
			</tr>
		</table>
	</div>
    </div>
</div>
{% endblock %}
